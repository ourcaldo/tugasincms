-- Enable RLS on all tables
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE posts ENABLE ROW LEVEL SECURITY;
ALTER TABLE categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE tags ENABLE ROW LEVEL SECURITY;
ALTER TABLE post_categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE post_tags ENABLE ROW LEVEL SECURITY;
ALTER TABLE api_tokens ENABLE ROW LEVEL SECURITY;

-- Users table policies
CREATE POLICY "Users can view all users" ON users FOR SELECT USING (true);
CREATE POLICY "Users can insert their own data" ON users FOR INSERT WITH CHECK (true);
CREATE POLICY "Users can update their own data" ON users FOR UPDATE USING (true);

-- Posts table policies
CREATE POLICY "Anyone can view published posts" ON posts FOR SELECT USING (status = 'published' OR true);
CREATE POLICY "Authenticated users can create posts" ON posts FOR INSERT WITH CHECK (true);
CREATE POLICY "Authors can update their own posts" ON posts FOR UPDATE USING (true);
CREATE POLICY "Authors can delete their own posts" ON posts FOR DELETE USING (true);

-- Categories table policies
CREATE POLICY "Anyone can view categories" ON categories FOR SELECT USING (true);
CREATE POLICY "Authenticated users can create categories" ON categories FOR INSERT WITH CHECK (true);
CREATE POLICY "Authenticated users can update categories" ON categories FOR UPDATE USING (true);
CREATE POLICY "Authenticated users can delete categories" ON categories FOR DELETE USING (true);

-- Tags table policies
CREATE POLICY "Anyone can view tags" ON tags FOR SELECT USING (true);
CREATE POLICY "Authenticated users can create tags" ON tags FOR INSERT WITH CHECK (true);
CREATE POLICY "Authenticated users can update tags" ON tags FOR UPDATE USING (true);
CREATE POLICY "Authenticated users can delete tags" ON tags FOR DELETE USING (true);

-- Post categories junction table policies
CREATE POLICY "Anyone can view post categories" ON post_categories FOR SELECT USING (true);
CREATE POLICY "Authenticated users can manage post categories" ON post_categories FOR ALL USING (true);

-- Post tags junction table policies
CREATE POLICY "Anyone can view post tags" ON post_tags FOR SELECT USING (true);
CREATE POLICY "Authenticated users can manage post tags" ON post_tags FOR ALL USING (true);

-- API tokens table policies
CREATE POLICY "Users can view their own tokens" ON api_tokens FOR SELECT USING (true);
CREATE POLICY "Users can create their own tokens" ON api_tokens FOR INSERT WITH CHECK (true);
CREATE POLICY "Users can update their own tokens" ON api_tokens FOR UPDATE USING (true);
CREATE POLICY "Users can delete their own tokens" ON api_tokens FOR DELETE USING (true);